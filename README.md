# ml-malware-detection
This repository contains a project for detecting malware using various machine learning models for Cyber Security course - University of Science and Technology - The University of Danang . The project includes scripts for data extraction, model training, inference, and a graphical user interface for demonstrating the models.

## Directory Structure

```
.
├── data
│   └── data.csv
├── demo_gui.py
├── dir_map.txt
├── extract_only_file.py
├── extract.py
├── main.py
├── model.py
├── models
│  
├── outputs
│   ├── catboost
│   │   ├── cm.png
│   │   ├── result.png
│   │   └── result.txt
│   ├── knn
│   │   ├── cm.png
│   │   ├── result.png
│   │   └── result.txt
│   ├── lightgbm
│   │   ├── cm.png
│   │   ├── result.png
│   │   └── result.txt
│   ├── naive_bayes
│   │   ├── cm.png
│   │   ├── result.png
│   │   └── result.txt
│   ├── random_forest
│   │   ├── cm.png
│   │   ├── result.png
│   │   └── resutl.txt
│   ├── simple_nn
│   │   ├── cm.png
│   │   ├── result.png
│   │   └── result.txt
│   ├── __tkinter_app
│   │   └── app.png
│   └── xgboost
│       ├── cm.png
│       ├── result.png
│       └── result.txt
├── README.md
├── requirements.txt
├── single_inference.py
├── util.py
└── visualization.ipynb
```

## File Desccriptions

- `extract.py`: This script helps in creating a wide data set from the corresponding folder.
- `extract_only_file.py`: This script is used to extract data from a single file. Usage:
  ```
  python extract_only_file.py {file_path}
  ```
- `main.py`: This script is used for training the models. See the instructions below on how to run this script.
- `single_inference.py`: This script is used to run inference on a single PE file's features. Usage:
  ```python
  parser = argparse.ArgumentParser(description="Run inference on a single PE file features.")
  parser.add_argument('--model', choices=['random_forest', 'xgboost', 'knn', 'naive_bayes', 'lightgbm', 'catboost', 'simple_nn'], required=True, help='Specify which model to use for inference')
  parser.add_argument('--file', type=str, required=True, help='Path to the .txt file containing PE file features')
  args = parser.parse_args()
  ```
- `demo_gui.py`: This script provides a graphical user interface (GUI) to demonstrate and select different machine learning algorithms. Note that you need to install `tkinter` in the global environment to run this script. Also, Make sure you have trained models in the models folder. The GUI demo screenshot is available in `outputs/__tkinter_app/app.png`.

## How to Run

### Requirements

First, install the required Python packages by running:

```bash
pip install -r requirements.txt
```

### Training Models

To train a model, use the `main.py` script. For example, to train a K-Nearest Neighbors (KNN) model, run:

```bash
python main.py --model knn
```

The available models are:
- `random_forest`
- `xgboost`
- `knn`
- `naive_bayes`
- `lightgbm`
- `catboost`
- `simple_nn`

### Running Inference

To run inference on a single PE file's features, use the `single_inference.py` script. For example, to use the XGBoost model, run:

```bash
python single_inference.py --model xgboost --file path/to/your/file.txt
```

### GUI Demo

To run the GUI demo, use the `demo_gui.py` script. Make sure `tkinter` is installed in the global environment. Run:

```bash
python demo_gui.py
```

A screenshot of the GUI can be found here:

![GUI Demo](outputs/__tkinter_app/app.png)

## Outputs

The results for each model are stored in the `outputs` directory. Each model has its own subdirectory containing:
- `cm.png`: Confusion Matrix
- `result.png`: Results visualization
- `result.txt`: Text file containing results

## Acknowledgments

This project utilizes several machine learning libraries including scikit-learn, XGBoost, LightGBM, CatBoost, and TensorFlow. For KNN, Neural Network, Naive Bayes and Random Forest, we implemented it ourselves without using libraries.

## Feedback

For any feedback or suggestions, please contact meowt207@gmail.com.
